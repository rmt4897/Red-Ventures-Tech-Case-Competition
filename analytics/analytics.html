<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>Leaflet Heatmap Layer Plugin</title>
	<style>
		body,
		html {
			margin: 0;
			padding: 0;
			height: 100%;
		}

		body {
			font-family: sans-serif;
		}

		body * {
			font-weight: 200;
		}

		h1 {
			position: absolute;
			background: white;
			padding: 10px;
		}

		#map {
			height: 100%;
		}

		.leaflet-container {
			background: rgba(0, 0, 0, .8) !important;
		}

		h1 {
			position: absolute;
			background: black;
			color: white;
			padding: 10px;
			font-weight: 200;
			z-index: 10000;
		}

		#all-examples-info {
			position: absolute;
			background: white;
			font-size: 16px;
			padding: 20px;
			top: 100px;
			width: 350px;
			line-height: 150%;
			border: 1px solid rgba(0, 0, 0, .2);
		}
	</style>
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
	<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
	<script src="heatmap.js"></script>
	<script src="gmap-heatmap.js"></script>
</head>

<body>
	<h1>Leaflet Heatmap Layer Example</h1>

	<div id="map"></div>

	<div id="all-examples-info">
		<strong style="font-weight:bold;line-height:200%;font-size:18px;">Looking for more examples?</strong>
		<br />Check out the full <a href="http://www.patrick-wied.at/static/heatmapjs/examples.html?utm_source=gh_local"
			target="_blank">list of all heatmap.js examples</a> with more pointers &amp; inline documentation.
	</div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
	<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-app.js"></script>

	<!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
	<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-analytics.js"></script>

	<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-firestore.js"></script>


	<script type="text/javascript" charset="utf-8" src="databasePull.js"></script>


	<script>
		function loadData(array) {
			var testData = array;
			var baseLayer = L.tileLayer(
				'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
					attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>',
					maxZoom: 18
				}
			);
			var cfg = {
				// radius should be small ONLY if scaleRadius is true (or small radius is intended)
				"radius": 2,
				"maxOpacity": .8,
				// scales the radius based on map zoom
				"scaleRadius": true,
				// if set to false the heatmap uses the global maximum for colorization
				// if activated: uses the data maximum within the current map boundaries 
				//   (there will always be a red spot with useLocalExtremas true)
				"useLocalExtrema": true,
				// which field name in your data represents the latitude - default "lat"
				latField: 'lat',
				// which field name in your data represents the longitude - default "lng"
				lngField: 'lng',
				// which field name in your data represents the data value - default "value"
				valueField: 'count'
			};
			var heatmapLayer = new HeatmapOverlay(cfg);
			var map = new L.Map('map', {
				center: new L.LatLng(25.6586, -80.3568),
				zoom: 4,
				layers: [baseLayer, heatmapLayer]
			});

			// make accessible for debugging
			layer = heatmapLayer;

			location_data(testData);

			layer.setData(masfy_api_data);
		};

		var masfy_api_data;
		function location_data(our_data) {
			masfy_api_data = {
				max: 10000,
				data: []
			};
			var api_array = [];
			for (i = 0; i < our_data.data.length; i++) {
				var newData = {
					lat: our_data.data[i].lat,
					lng: our_data.data[i].lng,
					count: 1
				};
				api_array.push(newData);
			}

			masfy_api_data.data = api_array;

		}
		var test = {}

		loadData(test);

		console.log(masfy_api_data);
		
	</script>
</body>

</html>